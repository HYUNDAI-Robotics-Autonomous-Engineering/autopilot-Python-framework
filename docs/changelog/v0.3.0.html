

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>v0.3.0 (Februrary DATE, 2020) &mdash; Autopilot 0.2 documentation</title>
  

  
  
  
  
    <link rel="canonical" href="docs.auto-pi-lot.comchangelog/v0.3.0.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/autopilot_theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="v0.2.0 (October 26, 2019)" href="v0.2.0.html" />
    <link rel="prev" title="Changelog" href="index.html" />

    <link href="https://fonts.googleapis.com/css?family=Cutive+Mono&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Work+Sans:300,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Dosis&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lexend+Deca&display=swap" rel="stylesheet">


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Autopilot
          

          
            
            <img src="../_static/autopilot_logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide.overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide.overview.html#concepts-and-terms-in-autopilot">Concepts and Terms in Autopilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide.overview.html#program-structure-overview">Program Structure Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide.overview.html#tasks">Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide.overview.html#hardware">Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide.overview.html#agents">Agents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide.installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide.installation.pilot.html">Pilot Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide.installation.pilot.html#scripted-installation">Scripted Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.installation.pilot.html#manual-preinstall">Manual Preinstall</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide.installation.pilot.html#rasbian-installation">Rasbian Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.installation.pilot.html#raspbian-performance-improvements">Raspbian Performance Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.installation.pilot.html#audio-setup">Audio Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.installation.pilot.html#video-setup">Video Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.installation.pilot.html#optional-installation-steps">Optional Installation Steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide.installation.terminal.html">Terminal Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide.installation.terminal.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.installation.terminal.html#scripted-terminal-setup">Scripted Terminal Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.installation.terminal.html#manual-terminal-presetup">Manual Terminal Presetup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide.installation.terminal.html#compiling-installing-qt4-linux">Compiling &amp; Installing Qt4 - Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.installation.terminal.html#installing-qt4-macos">Installing Qt4 - MacOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.installation.terminal.html#compiling-installing-pyside-linux-macos">Compiling &amp; Installing PySide - Linux + macOS</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide.training.html">Training a Subject</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide.training.html#connecting-the-pilot">Connecting the Pilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide.training.html#creating-a-protocol">Creating a Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide.training.html#using-the-protocol-wizard">Using the Protocol Wizard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.training.html#manual-protocol-creation">Manual Protocol Creation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide.training.html#creating-a-subject">Creating a Subject</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide.training.html#running-the-task">Running the Task</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide.training.html#debugging-a-task">Debugging a Task</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide.task.html">Writing a Task</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide.task.html#the-nafc-task">The Nafc Task</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#the-task-class">The <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#four-task-attributes">Four Task Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide.task.html#params">PARAMS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.task.html#data">Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.task.html#plot">PLOT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.task.html#hardware">HARDWARE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#initialization">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#stage-methods">Stage Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide.task.html#request">Request</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.task.html#discrim">Discrim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide.task.html#reinforcement">Reinforcement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#additional-methods">Additional Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide.task.html#distributed-go-no-go-using-child-agents">Distributed Go/No-Go - Using Child Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#additional-prefs">Additional Prefs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#go-no-go-parameterization">Go/No-Go Parameterization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#id5">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#the-child-task">The Child Task</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#a-very-smart-wheel">A Very Smart Wheel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.task.html#go-no-go-stage-methods">Go/No-Go Stage Methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide.hardware.html">Writing a Hardware Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide.hardware.html#gpio-with-pigpio">GPIO with pigpio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide.hardware.html#input-beambreak">Input - Beambreak</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide.hardware.html#output-led-rgb">Output - LED_RGB</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide.hardware.html#usb-hardware-with-inputs">USB Hardware with inputs</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../autopilot.core.html">Core Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.core.gui.html">gui</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.core.hardware.html">hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.core.networking.html">networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.core.pilot.html">pilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.core.plots.html">plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.core.styles.html">styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.core.subject.html">subject</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.core.terminal.html">terminal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.core.utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../autopilot.tasks.html">Tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.tasks.free_water.html">free_water</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.tasks.graduation.html">graduation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.tasks.nafc.html">nafc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.tasks.task.html">task</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../autopilot.stim.html">Stimuli</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.stim.managers.html">managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.stim.sound.html">sound</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../autopilot.stim.sound.jackclient.html">jackclient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autopilot.stim.sound.pyoserver.html">pyoserver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autopilot.stim.sound.sounds.html">sounds</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../autopilot.viz.html">Visualization Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.viz.trial_viewer.html">trial_viewer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../autopilot.setup.html">Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.setup.setup_pilot.html">setup_pilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.setup.setup_scale.html">setup_scale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autopilot.setup.setup_terminal.html">setup_terminal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../autopilot.prefs.html">Prefs</a></li>
</ul>
<p class="caption"><span class="caption-text">Meta:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../todo.html">To-Do</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../todo.html#completed-goals">Completed Goals</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Changelog</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#version-0-3">Version 0.3</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">v0.3.0 (Februrary DATE, 2020)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#major-updates">Major Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#minor-updates">Minor Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#new-features">New Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bugfixes">Bugfixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code-structure">Code Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#external-libraries">External Libraries</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#version-0-2">Version 0.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="v0.2.0.html">v0.2.0 (October 26, 2019)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Autopilot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Changelog</a> &raquo;</li>
        
      <li>v0.3.0 (Februrary DATE, 2020)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/changelog/v0.3.0.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="v0-3-0-februrary-date-2020">
<span id="changelog-v030"></span><h1>v0.3.0 (Februrary DATE, 2020)<a class="headerlink" href="#v0-3-0-februrary-date-2020" title="Permalink to this headline">¶</a></h1>
<div class="section" id="major-updates">
<h2>Major Updates<a class="headerlink" href="#major-updates" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Python 3</strong> - We’ve finally made it to Python 3! Specifically we have brought Autopilot up to compatibility with Python 3.8.
I will <em>not attempt to keep Autopilot compatible with Python 2</em>, but no decision has been made about compatibility
with other versions of Python 3. Until then, expect that Autopilot will attempt to keep up with major version changes.
The switch also let up update PySide (Qt library used for the GUI) to PySide2, which uses Qt5 and has a whole raft of other improvements.</p></li>
<li><p><strong>Continuous Data Handling</strong> - The <a class="reference internal" href="../autopilot.core.subject.html#autopilot.core.subject.Subject" title="autopilot.core.subject.Subject"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subject</span></code></a> class and <a class="reference internal" href="../autopilot.core.networking.html#module-autopilot.core.networking" title="autopilot.core.networking"><code class="xref py py-mod docutils literal notranslate"><span class="pre">networking</span></code></a> modules have been improved
to handle continuous data (eg. streaming data, generally non-trialwise or non-event-sampled data). Continuous data
can be set in a Task description either with a <code class="docutils literal notranslate"><span class="pre">tables</span></code> column descriptor as trial data is, but also can be set as
<code class="docutils literal notranslate"><span class="pre">'infer'</span></code>, for which the <a class="reference internal" href="../autopilot.core.subject.html#autopilot.core.subject.Subject" title="autopilot.core.subject.Subject"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subject</span></code></a> class will wait until it receives the first data and
automatically create a <code class="docutils literal notranslate"><span class="pre">tables</span></code> column depending on its type and shape. While previously we intended to nudge users
to be explicit about declaring their data, this was necessary to allow for data that might be variable in type and shape
to be included in a Task – eg. it should be possible to record video data without needing to specify the resolution
or bit depth as a hardcoded parameter in a task class. I have come to like type inference, and may make it a general
practice for all types of data. That would potentially allow tasks to be written without explicitly declaring the
data that they produce at all, but I haven’t decided if that’s a good thing or not yet.</p></li>
<li><p>The <strong>GPIO engine</strong> has been rebuilt, relying more on <code class="docutils literal notranslate"><span class="pre">pigpio</span></code>’s function interface. This means that GPIO timing is now
~microsecond precise, important for reward delivery, LED flashing, and a number of other basic infrastructural needs.
The reorganization of hardware modules resulted in general <code class="xref py py-class docutils literal notranslate"><span class="pre">GPIO</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Digital_In</span></code>
and <code class="xref py py-class docutils literal notranslate"><span class="pre">Digital_Out</span></code> metaclasses, making common operations like setting polarity, triggers, and pullup/down resistors
much easier.</p></li>
</ul>
</div>
<div class="section" id="minor-updates">
<h2>Minor Updates<a class="headerlink" href="#minor-updates" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p><strong>Logging</strong> level is now set from <code class="docutils literal notranslate"><span class="pre">prefs</span></code>, so where before, eg. every message through the networking modules would be logged to stdout,
now only warnings and exceptions are. This gives a surprisingly large performance boost.</p>
<blockquote>
<div><ul class="simple">
<li><p>Logging has also been much improved in <a class="reference internal" href="../autopilot.core.networking.html#module-autopilot.core.networking" title="autopilot.core.networking"><code class="xref py py-mod docutils literal notranslate"><span class="pre">networking</span></code></a> modules, where rather than an awkward <code class="docutils literal notranslate"><span class="pre">do_logging</span></code> flag
that was used to avoid logging performance-critical events like streaming data, logging is controlled by log level throughout the system.
By default, logging of most messages is set at <code class="docutils literal notranslate"><span class="pre">debug</span></code> level so they don’t drown out important messages in the logs as they used to.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Networking</strong> modules now only deserialize messages if they are the final recipient, saving lots of processing time – particularly
with streamed arrays. <a class="reference internal" href="../autopilot.core.networking.html#autopilot.core.networking.Message" title="autopilot.core.networking.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a> objects also only re-serialize messages if they have been changed.
Message structure has been changed such that serialized messages are now of the general format:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">sender</span><span class="p">,</span>
 <span class="p">(</span><span class="n">optional</span><span class="p">)</span> <span class="n">intermediate_node_1</span><span class="p">,</span> <span class="n">intermediate_node_2</span><span class="p">,</span> <span class="o">...</span>
 <span class="n">final_recipient</span><span class="p">,</span>
 <span class="n">message_contents</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Configuration will continue to be a point of improvement, but a few minor updates were made:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prefs.CONFIG</span></code> will be used to signal multiple, potentially overlapping agent configurations, each of which
may have their own system dependencies, external daemons, etc. Eg. a Pilot could
be configured to play audio (which requires a jackd daemon to be started before Autopilot) and video
(which requires Autopilot to be started in a X session). Checks of <code class="docutils literal notranslate"><span class="pre">prefs.CONFIG</span></code> are now <code class="docutils literal notranslate"><span class="pre">in</span></code> rather than
<code class="docutils literal notranslate"><span class="pre">==</span></code> to reflect that.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prefs.PINS</span></code> was renamed <code class="docutils literal notranslate"><span class="pre">prefs.HARDWARE</span></code>, and now allows hardware to be configured with dictionaries rather than
integers only. Initially <code class="docutils literal notranslate"><span class="pre">PINS</span></code> was meant to just contain pin numbering for GPIO objects, but having a single point of
hardware configuration is preferable. <a class="reference internal" href="../autopilot.tasks.task.html#autopilot.tasks.task.Task.init_hardware" title="autopilot.tasks.task.Task.init_hardware"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Task.init_hardware()</span></code></a> now respects all parameters set in <code class="docutils literal notranslate"><span class="pre">prefs</span></code>.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Throughout the code, minimal <code class="docutils literal notranslate"><span class="pre">get_this</span></code> type methods have begun to be replaced with <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> attributes. This is because a) I
love them and think they are magical, but b) will also be building Autopilot’s closed-loop infrastructure around a Qt-style
signal/slot architecture that wraps <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> attributes so they can be <code class="docutils literal notranslate"><span class="pre">.connected</span></code> to one another easily.</p></li>
<li><p>Previously it was possible to control presentation by <em>groups</em> of stimuli, but now it is possible to control the
presentation frequency of individual stimuli.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PySide2</span></code> has proper support for CSS Stylesheets, so the design of Autopilot’s GUI has been marginally improved,
a process that will continue in the ceaseless quest for aesthetic perfection.</p></li>
<li><p>Several setup routines have been added to make installation of opencv, pyspin, etc. easier. I also wrote a routine
to <code class="xref py py-func docutils literal notranslate"><span class="pre">download_box()</span></code> files from a URL, which is mysteriously hard to do.</p></li>
<li><p>The <a class="reference internal" href="../todo.html#todo"><span class="std std-ref">To-Do</span></a> page now reflects the full ambition of Autopilot, where before this vision was contained only in
the <a class="reference external" href="https://www.biorxiv.org/content/10.1101/807693v1">whitepaper</a> and a disorganized <a class="reference external" href="https://github.com/wehr-lab/autopilot/blob/master/notes/todo">plaintext</a> file in the repo.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">serve</span></code> command for the docs now uses <a class="reference external" href="https://github.com/GaretJax/sphinx-autobuild">sphinx-autobuild</a>, so they are rebuilt as they are changed and the page auto-reloads</p></li>
<li><p>The <a class="reference internal" href="../autopilot.core.subject.html#autopilot.core.subject.Subject" title="autopilot.core.subject.Subject"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subject</span></code></a> class can now export trial data <a class="reference internal" href="../autopilot.core.subject.html#autopilot.core.subject.Subject.to_csv" title="autopilot.core.subject.Subject.to_csv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_csv()</span></code></a>. A very minor update, but
one that is the first in a number of planned improvements to data export.</p></li>
<li><p>I have also opened up a message board in google groups to make feature requests and discuss use and development, hope to see you there :)</p>
<p><a class="reference external" href="https://groups.google.com/forum/#!forum/autopilot-users">https://groups.google.com/forum/#!forum/autopilot-users</a></p>
</li>
</ul>
</div>
<div class="section" id="new-features">
<h2>New Features<a class="headerlink" href="#new-features" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p><strong>HARDWARE</strong> has been substantially refactored to give objects an appropriate inheritance structure. This substantially
reduces effort duplication across hardware objects and makes a bunch of obvious capabilities available to all of them,
for example all hardware objects are now network (<code class="xref py py-meth docutils literal notranslate"><span class="pre">init_networking()</span></code>) and logging (<code class="xref py py-meth docutils literal notranslate"><span class="pre">init_logging()</span></code>)
capable.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Cameras</strong>: The <code class="xref py py-class docutils literal notranslate"><span class="pre">cameras.Camera_CV</span></code> class allows webcams/other simple cameras to be accessed through OpenCV,
and the <code class="xref py py-class docutils literal notranslate"><span class="pre">cameras.Camera_Spinnaker</span></code> class allows FLIR and other cameras to be accessed through the <a class="reference external" href="https://www.flir.com/products/spinnaker-sdk/">Spinnaker</a> SDK.
Cameras are capable of encoding videos locally (with x264), streaming frames over the network, and making
acquired frames available to other objects on the same computer. The <code class="xref py py-class docutils literal notranslate"><span class="pre">Camera_Spinnaker</span></code> class
provides simple <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> setter/getter methods for common parameters, but also makes all <code class="docutils literal notranslate"><span class="pre">PySpin</span></code> attributes
available to the user with its <code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">set()</span></code> methods.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">cameras.Camera</span></code> metaclass is written so that new camera types can be added by overriding a few methods. A
new <code class="xref py py-class docutils literal notranslate"><span class="pre">Video_Child</span></code> can be used to run a camera on a Child agent.</p></li>
<li><p><strong>9DOF Motion Sensor</strong>: The <code class="xref py py-class docutils literal notranslate"><span class="pre">i2c.I2C_9DOF</span></code> class can use the LSM9DS1 sensor to collect accelerometer, magnetometer, and
gyroscopic data to compute unambiguous position and orientation information. We will be including calibration and
computation routines that make it easier to extract properties of interest – eg. computing vertical motion by
combining readings from the three sensors.</p></li>
<li><p><strong>Temperature Sensor</strong>: The <code class="xref py py-class docutils literal notranslate"><span class="pre">i2c.MLX90640</span></code> class can use the <a class="reference external" href="https://www.melexis.com/en/product/MLX90640/Far-Infrared-Thermal-Sensor-Array">MLX90640</a> sensor to measure temperature. The
sensor is 32x24px, which the class can <code class="xref py py-meth docutils literal notranslate"><span class="pre">interpolate()</span></code>. The class also allows frames to be integrated
and averaged over time, substantially reducing noise. I modified the driver library to enable capture at the full
64fps on the Raspberry Pi.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>NETWORKING</strong> modules can stream continuous data better in a few ways:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="../autopilot.core.networking.html#autopilot.core.networking.Net_Node" title="autopilot.core.networking.Net_Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Net_Node</span></code></a> modules were given a <a class="reference internal" href="../autopilot.core.networking.html#autopilot.core.networking.Net_Node.get_stream" title="autopilot.core.networking.Net_Node.get_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_stream()</span></code></a> method that lets objects, well,
stream data. Specifically, they are given a <code class="xref py py-class docutils literal notranslate"><span class="pre">queue.Queue</span></code> to shovel data into, which is then picked up by a
dedicated <a class="reference external" href="https://pyzmq.readthedocs.io/en/latest/api/zmq.html#zmq.Socket" title="(in PyZMQ v18.1.0.dev)"><code class="xref py py-class docutils literal notranslate"><span class="pre">zmq.Socket</span></code></a> in its own thread, which handles batching, serialization, and load balancing. Streamed
messages are batched (ie. contain multiple messages), but behave like normal message when received – they are split and
contain an <code class="docutils literal notranslate"><span class="pre">inner_key</span></code> that is used to call the <code class="docutils literal notranslate"><span class="pre">listen</span></code> with each message (see <code class="xref py py-meth docutils literal notranslate"><span class="pre">l_stream()</span></code>).</p></li>
<li><p><a class="reference internal" href="../autopilot.core.networking.html#module-autopilot.core.networking" title="autopilot.core.networking"><code class="xref py py-mod docutils literal notranslate"><span class="pre">networking</span></code></a> objects also now compress arrays-in-transit with the superfast <a class="reference external" href="http://python-blosc.blosc.org/">blosc</a> compression library.
This increases their throughput dramatically, as many data streams in neuroscience are relatively low-entropy
(eg. the pixels in a video of a mostly-white arena are mostly unchanged frame-to-frame and are thus highly compressible).
See the <a class="reference internal" href="../autopilot.core.networking.html#autopilot.core.networking.Message._serialize_numpy" title="autopilot.core.networking.Message._serialize_numpy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Message._serialize_numpy()</span></code></a> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Message._deserialize_numpy()</span></code> methods.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>STIMULI</strong> - The <a class="reference internal" href="../autopilot.stim.sound.jackclient.html#autopilot.stim.sound.jackclient.JackClient" title="autopilot.stim.sound.jackclient.JackClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">JackClient</span></code></a> can now play continuous sounds rather than discrete sounds. An example
can be found in the <a class="reference internal" href="../autopilot.tasks.nafc.html#autopilot.tasks.nafc.Nafc_Gap" title="autopilot.tasks.nafc.Nafc_Gap"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nafc_Gap</span></code></a> task, which plays continuous white noise. All sounds now have a
<code class="xref py py-meth docutils literal notranslate"><span class="pre">play_continuous()</span></code> method, which continually dumps samples in a cycle into a queue for
the <a class="reference internal" href="../autopilot.stim.sound.jackclient.html#autopilot.stim.sound.jackclient.JackClient" title="autopilot.stim.sound.jackclient.JackClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">JackClient</span></code></a>. The continuous sound will be interrupted if another sound has its <a class="reference internal" href="../autopilot.stim.sound.sounds.html#autopilot.stim.sound.sounds.Jack_Sound.play" title="autopilot.stim.sound.sounds.Jack_Sound.play"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Jack_Sound.play()</span></code></a>
method called, but the continuous sound will resume seamlessly even if number of samples in the played sound aren’t a
multiple of the jack buffer size. We use this for gaps in noise (using the new <a class="reference internal" href="../autopilot.stim.sound.sounds.html#autopilot.stim.sound.sounds.Gap" title="autopilot.stim.sound.sounds.Gap"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gap</span></code></a> class),
which we have confirmed are sample-accurate.</p></li>
<li><p><strong>UI &amp; VIZ</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>A <a class="reference internal" href="../autopilot.core.plots.html#autopilot.core.plots.Video" title="autopilot.core.plots.Video"><code class="xref py py-class docutils literal notranslate"><span class="pre">Video</span></code></a> window has been created to display streaming video. The <code class="xref py py-meth docutils literal notranslate"><span class="pre">Terminal_Networking.l_continuous()</span></code> method
meters frames such that even if high-speed video is being acquired, frames are only sent at a rate of <code class="docutils literal notranslate"><span class="pre">prefs.DRAWFPS</span></code>.
The <a class="reference internal" href="../autopilot.core.plots.html#autopilot.core.plots.Video" title="autopilot.core.plots.Video"><code class="xref py py-class docutils literal notranslate"><span class="pre">Video</span></code></a> class uses the <a class="reference internal" href="../autopilot.core.plots.html#autopilot.core.plots.ImageItem_TimedUpdate" title="autopilot.core.plots.ImageItem_TimedUpdate"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageItem_TimedUpdate</span></code></a> object, a slight modification of
<code class="xref py py-class docutils literal notranslate"><span class="pre">pyqtgraph.ImageItem</span></code>, that calls its <code class="docutils literal notranslate"><span class="pre">update</span></code> method according to a <code class="xref py py-class docutils literal notranslate"><span class="pre">PySide2.QtCore.QTimer</span></code>.</p></li>
<li><p>A <code class="xref py py-attr docutils literal notranslate"><span class="pre">plots_menu</span></code> menu has been added to the Terminal, and a GUI dialog (<a class="reference internal" href="../autopilot.core.gui.html#autopilot.core.gui.Psychometric" title="autopilot.core.gui.Psychometric"><code class="xref py py-class docutils literal notranslate"><span class="pre">gui.Psychometric</span></code></a>)
has been added to create simple psychometric curves with the <code class="xref py py-mod docutils literal notranslate"><span class="pre">viz.psychometric</span></code> module, which uses <a class="reference external" href="https://altair-viz.github.io/">altair</a>.
Plans for developing visualization are described in <a class="reference internal" href="../todo.html#todo"><span class="std std-ref">To-Do</span></a>.</p></li>
<li><p>A general <a class="reference internal" href="../autopilot.core.gui.html#autopilot.core.gui.pop_dialog" title="autopilot.core.gui.pop_dialog"><code class="xref py py-func docutils literal notranslate"><span class="pre">gui.pop_dialog()</span></code></a> function simplifies displaying messages to the user using the Terminal UI. This was an initial step
towards improving status/error reporting from other agents, further detailed in <a class="reference internal" href="../todo.html#todo"><span class="std std-ref">To-Do</span></a>.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="bugfixes">
<h2>Bugfixes<a class="headerlink" href="#bugfixes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Some objects, particularly several <a class="reference internal" href="../autopilot.core.gui.html#module-autopilot.core.gui" title="autopilot.core.gui"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gui</span></code></a> objects, had the old <cite>mouse</cite>/<cite>mice</cite> terminology updated to <cite>subject</cite>/<cite>subjects</cite>.</p></li>
<li><p><a class="reference internal" href="../autopilot.core.networking.html#autopilot.core.networking.Net_Node" title="autopilot.core.networking.Net_Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Net_Node</span></code></a> objects were only implicitly destroyed by their <code class="xref py py-attr docutils literal notranslate"><span class="pre">release</span></code> method which ends the threaded loop by setting the <code class="xref py py-attr docutils literal notranslate"><span class="pre">closing</span></code> event.</p></li>
<li><p>Embarassingly, <a class="reference internal" href="../autopilot.core.pilot.html#autopilot.core.pilot.Pilot" title="autopilot.core.pilot.Pilot"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pilot</span></code></a> objects were not prevented from running multiple tasks at a time. This led to some very
confusing and hard-to-debug problems, as well as frequent conflicts over hardware access and resources. Typically what would
happen is the Terminal would send a <code class="docutils literal notranslate"><span class="pre">START</span></code> message to begin a task, and if it wouldn’t received a message receipt
quickly enough would resend it, resulting in two tasks being started – but this would happen whenever two <code class="docutils literal notranslate"><span class="pre">START</span></code> messages were sent
to a pilot. This was fixed with a simple check of <code class="xref py py-attr docutils literal notranslate"><span class="pre">Pilot.state</span></code> before a task is initialized. Similar bugs were fixed in
<a class="reference internal" href="../autopilot.core.plots.html#autopilot.core.plots.Plot" title="autopilot.core.plots.Plot"><code class="xref py py-class docutils literal notranslate"><span class="pre">Plot</span></code></a> objects.</p></li>
<li><p>The <a class="reference internal" href="../autopilot.core.subject.html#autopilot.core.subject.Subject" title="autopilot.core.subject.Subject"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subject</span></code></a> class would sometimes fail to get and increment the trial session. This has been fixed
by saving the session number as an attribute in the <code class="docutils literal notranslate"><span class="pre">info</span></code> node.</p></li>
<li><p>The <a class="reference internal" href="../autopilot.core.terminal.html#autopilot.core.terminal.Terminal.update_protocols" title="autopilot.core.terminal.Terminal.update_protocols"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_protocols()</span></code></a> method didn’t report which subjects had their protocols updated, and so if there was some
exception when setting new protocols it happened silently, making it so a user would never know their task was never updated.
This was fixed with a noisier protocol update method for the Subject class and by displaying a list of subjects that were updated
after the method is called.</p></li>
<li><p>Correction trials were being calculated incorrectly by the <a class="reference internal" href="../autopilot.stim.managers.html#autopilot.stim.managers.Stim_Manager" title="autopilot.stim.managers.Stim_Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stim_Manager</span></code></a>, such that rather than
only repeating a stimulus <em>if the subject got the previous trial incorrect,</em> the stimulus was always repeated at least once.</p></li>
</ul>
</div>
<div class="section" id="code-structure">
<h2>Code Structure<a class="headerlink" href="#code-structure" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>Modified versions of external libraries have been added as git submodules in <cite>autopilot/external</cite>.</p></li>
<li><p>Requirements files have been split out to better differentiate between different agents and use-cases.
eg. requirements for Terminal agents are in <code class="docutils literal notranslate"><span class="pre">requirements_terminal.txt</span></code>, requirements for build the docs are in <code class="docutils literal notranslate"><span class="pre">requirements_docs.txt</span></code>, etc.
This is a temporary arrangement, as a future design goal is restructuring setup routines so that they can flexibly install components as-needed (see <a class="reference internal" href="../todo.html#todo"><span class="std std-ref">To-Do</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">autopilot.core.hardware</span></code> has been refactored into its own module, <code class="xref py py-mod docutils literal notranslate"><span class="pre">autopilot.hardware</span></code>, and split by device type, currently…</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">autopilot.cameras</span></code></p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">autopilot.gpio</span></code> - devices that use the GPIO pins for standard digital I/O logic</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">autopilot.i2c</span></code> - devices that use the GPIO pins for I2C</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">autopilot.usb</span></code></p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="external-libraries">
<h2>External Libraries<a class="headerlink" href="#external-libraries" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>pigpio <a class="reference external" href="https://github.com/sneakers-the-rat/pigpio/">https://github.com/sneakers-the-rat/pigpio/</a></p>
<blockquote>
<div><ul>
<li><p>Added the ability to return absolute timestamps rather than system ticks.
pigpio typically returns 1 32-bit integer of ticks since the daemon started, absolute timestamps are 64-bit,
so the pigpio daemon and python interface (<cite>pi</cite>) were given two new methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>synchronize</cite> gets several (default 5) sets of paired timestamps and ticks using <cite>get_sync_time</cite>.
It then computes an offset for translating ticks to timestamps</p></li>
<li><p><cite>ticks_to_timestamp</cite> converts ticks to timestamps based on the offset found with <cite>synchronize</cite></p></li>
<li><p><cite>get_current_time</cite> sends two requests to the daemon to get the seconds and microseconds of the complete
timestamp and returns an isoformatted string</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>mlx90640-library <a class="reference external" href="https://github.com/pimoroni/mlx90640-library">https://github.com/pimoroni/mlx90640-library</a></p>
<blockquote>
<div><ul class="simple">
<li><p>Removed building examples by default which require additional dependencies</p></li>
<li><p>When using the raspi I2C driver, the baudrate would never be set to 1MHz, which is necessary to achieve full 64fps. This was fixed to use 1MHz by default.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="v0.2.0.html" class="btn btn-neutral float-right" title="v0.2.0 (October 26, 2019)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Changelog" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jonny Saunders

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>