


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>subject &mdash; Autopilot 0.3.0 documentation</title>
  

  
  
  
  
    <link rel="canonical" href="docs.auto-pi-lot.comautopilot.core.subject.html"/>
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/autopilot_theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="_static/restyle.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/autopilot_sass.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/autopilot_sass.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="terminal" href="autopilot.core.terminal.html" />
    <link rel="prev" title="styles" href="autopilot.core.styles.html" />

    <link href="https://fonts.googleapis.com/css?family=Cutive+Mono&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Work+Sans:300,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Dosis&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lexend+Deca&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="_static/css/autopilot_sass.css" type="text/css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.2.0/anime.min.js" integrity="sha256-BuxrUdr/4YoztQLxT6xmdO6hSQw2d6BtBUY1pteGds4=" crossorigin="anonymous"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Autopilot
          

          
            
            <img src="_static/autopilot_logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="guide.overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guide.overview.html#program-structure">Program Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide.overview.html#tasks">Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide.overview.html#module-tour">Module Tour</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guide.installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guide.installation.pilot.html">Pilot Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="guide.installation.pilot.html#scripted-installation">Scripted Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.installation.pilot.html#manual-preinstall">Manual Preinstall</a><ul>
<li class="toctree-l4"><a class="reference internal" href="guide.installation.pilot.html#rasbian-installation">Rasbian Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="guide.installation.pilot.html#raspbian-performance-improvements">Raspbian Performance Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="guide.installation.pilot.html#audio-setup">Audio Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="guide.installation.pilot.html#video-setup">Video Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="guide.installation.pilot.html#optional-installation-steps">Optional Installation Steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="guide.installation.terminal.html">Terminal Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="guide.installation.terminal.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.installation.terminal.html#scripted-terminal-setup">Scripted Terminal Setup</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guide.training.html">Training a Subject</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guide.training.html#connecting-the-pilot">Connecting the Pilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide.training.html#creating-a-protocol">Creating a Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="guide.training.html#using-the-protocol-wizard">Using the Protocol Wizard</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.training.html#manual-protocol-creation">Manual Protocol Creation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="guide.training.html#creating-a-subject">Creating a Subject</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide.training.html#running-the-task">Running the Task</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide.training.html#debugging-a-task">Debugging a Task</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guide.task.html">Writing a Task</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guide.task.html#the-nafc-task">The Nafc Task</a><ul>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#the-task-class">The <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#four-task-attributes">Four Task Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="guide.task.html#params">PARAMS</a></li>
<li class="toctree-l4"><a class="reference internal" href="guide.task.html#data">Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="guide.task.html#plot">PLOT</a></li>
<li class="toctree-l4"><a class="reference internal" href="guide.task.html#hardware">HARDWARE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#initialization">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#stage-methods">Stage Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="guide.task.html#request">Request</a></li>
<li class="toctree-l4"><a class="reference internal" href="guide.task.html#discrim">Discrim</a></li>
<li class="toctree-l4"><a class="reference internal" href="guide.task.html#reinforcement">Reinforcement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#additional-methods">Additional Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="guide.task.html#distributed-go-no-go-using-child-agents">Distributed Go/No-Go - Using Child Agents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#additional-prefs">Additional Prefs</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#go-no-go-parameterization">Go/No-Go Parameterization</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#id5">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#the-child-task">The Child Task</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#a-very-smart-wheel">A Very Smart Wheel</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.task.html#go-no-go-stage-methods">Go/No-Go Stage Methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guide.hardware.html">Writing a Hardware Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guide.hardware.html#gpio-with-pigpio">GPIO with pigpio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="guide.hardware.html#input-beambreak">Input - Beambreak</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide.hardware.html#output-led-rgb">Output - LED_RGB</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="guide.hardware.html#usb-hardware-with-inputs">USB Hardware with inputs</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="autopilot.core.html">Core Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="autopilot.core.gui.html">gui</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.core.networking.html">networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.core.pilot.html">pilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.core.plots.html">plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.core.styles.html">styles</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">subject</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.core.terminal.html">terminal</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.core.utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="autopilot.hardware.html">Hardware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="autopilot.hardware.cameras.html">cameras</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.hardware.gpio.html">gpio</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.hardware.i2c.html">i2c</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.hardware.usb.html">usb</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="autopilot.tasks.html">Tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="autopilot.tasks.children.html">children</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.tasks.free_water.html">free_water</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.tasks.graduation.html">graduation</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.tasks.nafc.html">nafc</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.tasks.task.html">task</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="autopilot.stim.html">Stimuli</a><ul>
<li class="toctree-l2"><a class="reference internal" href="autopilot.stim.managers.html">managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.stim.sound.html">sound</a><ul>
<li class="toctree-l3"><a class="reference internal" href="autopilot.stim.sound.jackclient.html">jackclient</a></li>
<li class="toctree-l3"><a class="reference internal" href="autopilot.stim.sound.pyoserver.html">pyoserver</a></li>
<li class="toctree-l3"><a class="reference internal" href="autopilot.stim.sound.sounds.html">sounds</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="autopilot.viz.html">Visualization Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="autopilot.viz.trial_viewer.html">trial_viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.viz.psychometric.html">psychometric</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="autopilot.setup.html">Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="autopilot.setup.setup_pilot.html">setup_pilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.setup.setup_scale.html">setup_scale</a></li>
<li class="toctree-l2"><a class="reference internal" href="autopilot.setup.setup_terminal.html">setup_terminal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="autopilot.prefs.html">Prefs</a></li>
<li class="toctree-l1"><a class="reference internal" href="autopilot.external.html">External</a></li>
</ul>
<p class="caption"><span class="caption-text">Meta:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/forum/#!forum/autopilot-users">Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">To-Do</a><ul>
<li class="toctree-l2"><a class="reference internal" href="todo.html#visions">Visions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="todo.html#integrations">Integrations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="todo.html#roadmap-deeplabcut-integration">DeepLabCut Integration<span><a href="https://groups.google.com/forum/#!topic/autopilot-users/T-PNfrHDtzA" class="roadmap-dblink">priority: high | discuss>></a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="todo.html#roadmap-open-ephys-integration">Open Ephys Integration<span><a href="https://google.com" class="roadmap-dblink">priority: medium | discuss>></a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="todo.html#roadmap-bonsai-integration">Bonsai Integration<span><a href="https://google.com" class="roadmap-dblink">priority: low | discuss>></a></span></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="todo.html#closed-loop-behavior-processing-pipelines">Closed-Loop Behavior &amp; Processing Pipelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="todo.html#improvements">Improvements</a></li>
<li class="toctree-l2"><a class="reference internal" href="todo.html#bugs">Bugs</a></li>
<li class="toctree-l2"><a class="reference internal" href="todo.html#completed">Completed</a></li>
<li class="toctree-l2"><a class="reference internal" href="todo.html#lowest-priority">Lowest Priority</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog/index.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog/index.html#version-0-3">Version 0.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog/v0.3.0.html">v0.3.0 (March 3rd, 2020)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="changelog/v0.3.0.html#major-updates">Major Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog/v0.3.0.html#minor-updates">Minor Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog/v0.3.0.html#new-features">New Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog/v0.3.0.html#bugfixes">Bugfixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog/v0.3.0.html#code-structure">Code Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog/v0.3.0.html#external-libraries">External Libraries</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog/index.html#version-0-2">Version 0.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog/v0.2.0.html">v0.2.0 (October 26, 2019)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Autopilot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="autopilot.core.html">core</a> &raquo;</li>
        
      <li>subject</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/autopilot.core.subject.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-autopilot.core.subject">
<span id="subject"></span><h1>subject<a class="headerlink" href="#module-autopilot.core.subject" title="Permalink to this headline">¶</a></h1>
<p>Classes for managing data and protocol access and storage.</p>
<p>Currently named subject, but will likely be refactored to include other data
models should the need arise.</p>
<p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject" title="autopilot.core.subject.Subject"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Subject</span></code></a>([name, dir, file, new, biography])</p></td>
<td><p>Class for managing one subject’s data and protocol.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="autopilot.core.subject.Subject">
<em class="property">class </em><code class="sig-name descname">Subject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">new</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">biography</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for managing one subject’s data and protocol.</p>
<p>Creates a <code class="xref py py-mod docutils literal notranslate"><span class="pre">tables</span></code> hdf5 file in <cite>prefs.DATADIR</cite> with the general structure:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="o">/</span> <span class="n">root</span>
<span class="o">|---</span> <span class="n">current</span> <span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">filenode</span><span class="p">)</span> <span class="n">storing</span> <span class="n">the</span> <span class="n">current</span> <span class="n">task</span> <span class="k">as</span> <span class="n">serialized</span> <span class="n">JSON</span>
<span class="o">|---</span> <span class="n">data</span> <span class="p">(</span><span class="n">group</span><span class="p">)</span>
<span class="o">|</span>    <span class="o">|---</span> <span class="n">task_name</span>  <span class="p">(</span><span class="n">group</span><span class="p">)</span>
<span class="o">|</span>         <span class="o">|---</span> <span class="n">S</span><span class="c1">##_step_name</span>
<span class="o">|</span>         <span class="o">|</span>    <span class="o">|---</span> <span class="n">trial_data</span>
<span class="o">|</span>         <span class="o">|</span>    <span class="o">|---</span> <span class="n">continuous_data</span>
<span class="o">|</span>         <span class="o">|---</span> <span class="o">...</span>
<span class="o">|---</span> <span class="n">history</span> <span class="p">(</span><span class="n">group</span><span class="p">)</span>
<span class="o">|</span>    <span class="o">|---</span> <span class="n">hashes</span> <span class="o">-</span> <span class="n">history</span> <span class="n">of</span> <span class="n">git</span> <span class="n">commit</span> <span class="n">hashes</span>
<span class="o">|</span>    <span class="o">|---</span> <span class="n">history</span> <span class="o">-</span> <span class="n">history</span> <span class="n">of</span> <span class="n">changes</span><span class="p">:</span> <span class="n">protocols</span> <span class="n">assigned</span><span class="p">,</span> <span class="n">params</span> <span class="n">changed</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span>
<span class="o">|</span>    <span class="o">|---</span> <span class="n">weights</span> <span class="o">-</span> <span class="n">history</span> <span class="n">of</span> <span class="n">pre</span> <span class="ow">and</span> <span class="n">post</span><span class="o">-</span><span class="n">task</span> <span class="n">weights</span>
<span class="o">|</span>    <span class="o">|---</span> <span class="n">past_protocols</span> <span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="o">-</span> <span class="n">stash</span> <span class="n">past</span> <span class="n">protocol</span> <span class="n">params</span> <span class="n">on</span> <span class="n">reassign</span>
<span class="o">|</span>         <span class="o">|---</span> <span class="n">date_protocol_name</span> <span class="o">-</span> <span class="n">tables</span><span class="o">.</span><span class="n">filenode</span> <span class="n">of</span> <span class="n">a</span> <span class="n">previous</span> <span class="n">protocol</span><span class="s1">&#39;s params.</span>
<span class="o">|</span>         <span class="o">|---</span> <span class="o">...</span>
<span class="o">|---</span> <span class="n">info</span> <span class="o">-</span> <span class="n">group</span> <span class="k">with</span> <span class="n">biographical</span> <span class="n">information</span> <span class="k">as</span> <span class="n">attributes</span>
</pre></div>
</div>
<p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.Hash_Table" title="autopilot.core.subject.Subject.Hash_Table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Hash_Table</span></code></a>()</p></td>
<td><p>Class to describe table for hash history</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.History_Table" title="autopilot.core.subject.Subject.History_Table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">History_Table</span></code></a>()</p></td>
<td><p>Class to describe parameter and protocol change history</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.Weight_Table" title="autopilot.core.subject.Subject.Weight_Table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Weight_Table</span></code></a>()</p></td>
<td><p>Class to describe table for weight history</p></td>
</tr>
</tbody>
</table>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.apply_along" title="autopilot.core.subject.Subject.apply_along"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_along</span></code></a>([along, step])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.assign_protocol" title="autopilot.core.subject.Subject.assign_protocol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_protocol</span></code></a>(protocol[, step_n])</p></td>
<td><p>Assign a protocol to the subject.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.close_hdf" title="autopilot.core.subject.Subject.close_hdf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">close_hdf</span></code></a>(h5f)</p></td>
<td><p>Flushes &amp; closes the open hdf file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.data_thread" title="autopilot.core.subject.Subject.data_thread"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data_thread</span></code></a>(queue)</p></td>
<td><p>Thread that keeps hdf file open and receives data while task is running.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.ensure_structure" title="autopilot.core.subject.Subject.ensure_structure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ensure_structure</span></code></a>()</p></td>
<td><p>Ensure that our h5f has the appropriate baseline structure as defined in <cite>self.STRUCTURE</cite></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.flush_current" title="autopilot.core.subject.Subject.flush_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flush_current</span></code></a>()</p></td>
<td><p>Flushes the ‘current’ attribute in the subject object to the current filenode</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.get_step_history" title="autopilot.core.subject.Subject.get_step_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_step_history</span></code></a>([use_history])</p></td>
<td><p>Gets a dataframe of step numbers, timestamps, and step names as a coarse view of training status.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.get_timestamp" title="autopilot.core.subject.Subject.get_timestamp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_timestamp</span></code></a>([simple])</p></td>
<td><p>Makes a timestamp.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.get_trial_data" title="autopilot.core.subject.Subject.get_trial_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_trial_data</span></code></a>([step, what])</p></td>
<td><p>Get trial data from the current task.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.get_weight" title="autopilot.core.subject.Subject.get_weight"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_weight</span></code></a>([which, include_baseline])</p></td>
<td><p>Gets start and stop weights.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.graduate" title="autopilot.core.subject.Subject.graduate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">graduate</span></code></a>()</p></td>
<td><p>Increase the current step by one, unless it is the last step.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.new_subject_file" title="autopilot.core.subject.Subject.new_subject_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">new_subject_file</span></code></a>(biography)</p></td>
<td><p>Create a new subject file and make the general filestructure.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.open_hdf" title="autopilot.core.subject.Subject.open_hdf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">open_hdf</span></code></a>([mode])</p></td>
<td><p>Opens the hdf5 file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.prepare_run" title="autopilot.core.subject.Subject.prepare_run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_run</span></code></a>()</p></td>
<td><p>Prepares the Subject object to receive data while running the task.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.save_data" title="autopilot.core.subject.Subject.save_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_data</span></code></a>(data)</p></td>
<td><p>Alternate and equivalent method of putting data in the queue as <cite>Subject.data_queue.put(data)</cite></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.set_weight" title="autopilot.core.subject.Subject.set_weight"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weight</span></code></a>(date, col_name, new_value)</p></td>
<td><p>Updates an existing weight in the weight table.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.stash_current" title="autopilot.core.subject.Subject.stash_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stash_current</span></code></a>()</p></td>
<td><p>Save the current protocol in the history group and delete the node</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.stop_run" title="autopilot.core.subject.Subject.stop_run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stop_run</span></code></a>()</p></td>
<td><p>puts ‘END’ in the data_queue, which causes <a class="reference internal" href="#autopilot.core.subject.Subject.data_thread" title="autopilot.core.subject.Subject.data_thread"><code class="xref py py-meth docutils literal notranslate"><span class="pre">data_thread()</span></code></a> to end.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.to_csv" title="autopilot.core.subject.Subject.to_csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_csv</span></code></a>(path[, task, step])</p></td>
<td><p>Export trial data to .csv</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.update_biography" title="autopilot.core.subject.Subject.update_biography"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_biography</span></code></a>(params)</p></td>
<td><p>Change or make a new biographical attribute, stored as attributes of the <cite>info</cite> group.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.update_history" title="autopilot.core.subject.Subject.update_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_history</span></code></a>(type, name, value[, step])</p></td>
<td><p>Update the history table when changes are made to the subject’s protocol.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#autopilot.core.subject.Subject.update_weights" title="autopilot.core.subject.Subject.update_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_weights</span></code></a>([start, stop])</p></td>
<td><p>Store either a starting or stopping mass.</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lock</strong> (<a class="reference external" href="https://docs.python.org/3/library/threading.html#threading.Lock" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Lock</span></code></a>) – manages access to the hdf5 file</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Subject ID</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Path to hdf5 file - usually <cite>{prefs.DATADIR}/{self.name}.h5</cite></p></li>
<li><p><strong>current</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – current task parameters. loaded from
the ‘current’ <code class="xref py py-mod docutils literal notranslate"><span class="pre">filenode</span></code> of the h5 file</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – current step</p></li>
<li><p><strong>protocol_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – name of currently assigned protocol</p></li>
<li><p><strong>current_trial</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of current trial</p></li>
<li><p><strong>running</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag that signals whether the subject is currently running a task or not.</p></li>
<li><p><strong>data_queue</strong> (<a class="reference external" href="https://docs.python.org/3/library/queue.html#queue.Queue" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">queue.Queue</span></code></a>) – Queue to dump data while running task</p></li>
<li><p><strong>thread</strong> (<a class="reference external" href="https://docs.python.org/3/library/threading.html#threading.Thread" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Thread</span></code></a>) – thread used to keep file open while running task</p></li>
<li><p><strong>did_graduate</strong> (<a class="reference external" href="https://docs.python.org/3/library/threading.html#threading.Event" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Event</span></code></a>) – Event used to signal if the subject has graduated the current step</p></li>
<li><p><strong>STRUCTURE</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – <p>list of tuples with order:</p>
<ul>
<li><p>full path, eg. ‘/history/weights’</p></li>
<li><p>relative path, eg. ‘/history’</p></li>
<li><p>name, eg. ‘weights’</p></li>
<li><p>type, eg. <a class="reference internal" href="#autopilot.core.subject.Subject.Weight_Table" title="autopilot.core.subject.Subject.Weight_Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subject.Weight_Table</span></code></a> or ‘group’</p></li>
</ul>
</p></li>
<li><p><strong>locations</strong> (<em>node</em>) – <code class="xref py py-class docutils literal notranslate"><span class="pre">tables.IsDescriptor</span></code> for tables.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – subject ID</p></li>
<li><p><strong>dir</strong> (<em>str</em>) – path where the .h5 file is located, if <cite>None</cite>, <cite>prefs.DATADIR</cite> is used</p></li>
<li><p><strong>file</strong> (<em>str</em>) – load a subject from a filename. if <cite>None</cite>, ignored.</p></li>
<li><p><strong>new</strong> (<em>bool</em>) – if True, a new file is made (a new file is made if one does not exist anyway)</p></li>
<li><p><strong>biography</strong> (<em>dict</em>) – If making a new subject file, a dictionary with biographical data can be passed</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="autopilot.core.subject.Subject.open_hdf">
<code class="sig-name descname">open_hdf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'r+'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.open_hdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.open_hdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens the hdf5 file.</p>
<p>This should be called at the start of every method that access the h5 file
and <a class="reference internal" href="#autopilot.core.subject.Subject.close_hdf" title="autopilot.core.subject.Subject.close_hdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close_hdf()</span></code></a> should be called at the end. Otherwise
the file will close and we risk file corruption.</p>
<p>See the pytables docs
<a class="reference external" href="https://www.pytables.org/cookbook/threading.html">here</a> and
<a class="reference external" href="https://www.pytables.org/FAQ.html#can-pytables-be-used-in-concurrent-access-scenarios">here</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>str</em>) – a file access mode, can be:</p>
<ul class="simple">
<li><p>‘r’: Read-only - no data can be modified.</p></li>
<li><p>‘w’: Write - a new file is created (an existing file with the same name would be deleted).</p></li>
<li><p>‘a’ Append - an existing file is opened for reading and writing, and if the file does not exist it is created.</p></li>
<li><p>‘r+’ (default) - Similar to ‘a’, but file must already exist.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Opened hdf file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tables.File</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.close_hdf">
<code class="sig-name descname">close_hdf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h5f</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.close_hdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.close_hdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Flushes &amp; closes the open hdf file.
Must be called whenever <a class="reference internal" href="#autopilot.core.subject.Subject.open_hdf" title="autopilot.core.subject.Subject.open_hdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">open_hdf()</span></code></a> is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>h5f</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tables.File</span></code>) – the hdf file opened by <a class="reference internal" href="#autopilot.core.subject.Subject.open_hdf" title="autopilot.core.subject.Subject.open_hdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">open_hdf()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.new_subject_file">
<code class="sig-name descname">new_subject_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">biography</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.new_subject_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.new_subject_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new subject file and make the general filestructure.</p>
<p>If a file already exists, open it in append mode, otherwise create it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>biography</strong> (<em>dict</em>) – Biographical details like DOB, mass, etc.
Typically created by <code class="xref py py-class docutils literal notranslate"><span class="pre">Biography_Tab</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.ensure_structure">
<code class="sig-name descname">ensure_structure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.ensure_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.ensure_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that our h5f has the appropriate baseline structure as defined in <cite>self.STRUCTURE</cite></p>
<p>Checks that all groups and tables are made, makes them if not</p>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.update_biography">
<code class="sig-name descname">update_biography</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.update_biography"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.update_biography" title="Permalink to this definition">¶</a></dt>
<dd><p>Change or make a new biographical attribute, stored as
attributes of the <cite>info</cite> group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<em>dict</em>) – biographical attributes to be updated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.update_history">
<code class="sig-name descname">update_history</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">type</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.update_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.update_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the history table when changes are made to the subject’s protocol.</p>
<p>The current protocol is flushed to the past_protocols group and an updated
filenode is created.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This <strong>only</strong> updates the history table, and does not make the changes itself.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> (<em>str</em>) – What type of change is being made? Can be one of</p>
<ul>
<li><p>‘param’ - a parameter of one task stage</p></li>
<li><p>‘step’ - the step of the current protocol</p></li>
<li><p>‘protocol’ - the whole protocol is being updated.</p></li>
</ul>
</li>
<li><p><strong>name</strong> (<em>str</em>) – the name of either the parameter being changed or the new protocol</p></li>
<li><p><strong>value</strong> (<em>str</em>) – the value that the parameter or step is being changed to,
or the protocol dictionary flattened to a string.</p></li>
<li><p><strong>step</strong> (<em>int</em>) – When type is ‘param’, changes the parameter at a particular step,
otherwise the current step is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.assign_protocol">
<code class="sig-name descname">assign_protocol</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">protocol</span></em>, <em class="sig-param"><span class="n">step_n</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.assign_protocol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.assign_protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign a protocol to the subject.</p>
<p>If the subject has a currently assigned task, stashes it with <a class="reference internal" href="#autopilot.core.subject.Subject.stash_current" title="autopilot.core.subject.Subject.stash_current"><code class="xref py py-meth docutils literal notranslate"><span class="pre">stash_current()</span></code></a></p>
<p>Creates groups and tables according to the data descriptions in the task class being assigned.
eg. as described in <code class="xref py py-class docutils literal notranslate"><span class="pre">Task.TrialData</span></code>.</p>
<p>Updates the history table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protocol</strong> (<em>str</em>) – the protocol to be assigned. Can be one of</p>
<ul>
<li><p>the name of the protocol (its filename minus .json) if it is in <cite>prefs.PROTOCOLDIR</cite></p></li>
<li><p>filename of the protocol (its filename with .json) if it is in the <cite>prefs.PROTOCOLDIR</cite></p></li>
<li><p>the full path and filename of the protocol.</p></li>
</ul>
</li>
<li><p><strong>step_n</strong> (<em>int</em>) – Which step is being assigned?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.flush_current">
<code class="sig-name descname">flush_current</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.flush_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.flush_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Flushes the ‘current’ attribute in the subject object to the current filenode
in the .h5</p>
<p>Used to make sure the stored .json representation of the current task stays up to date
with the params set in the subject object</p>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.stash_current">
<code class="sig-name descname">stash_current</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.stash_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.stash_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the current protocol in the history group and delete the node</p>
<p>Typically this is called when assigning a new protocol.</p>
<p>Stored as the date that it was changed followed by its name if it has one</p>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.prepare_run">
<code class="sig-name descname">prepare_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.prepare_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.prepare_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the Subject object to receive data while running the task.</p>
<p>Gets information about current task, trial number,
spawns <a class="reference internal" href="autopilot.tasks.graduation.html#autopilot.tasks.graduation.Graduation" title="autopilot.tasks.graduation.Graduation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graduation</span></code></a> object,
spawns <code class="xref py py-attr docutils literal notranslate"><span class="pre">data_queue</span></code> and calls <a class="reference internal" href="#autopilot.core.subject.Subject.data_thread" title="autopilot.core.subject.Subject.data_thread"><code class="xref py py-meth docutils literal notranslate"><span class="pre">data_thread()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>the parameters for the current step, with subject id, step number,</dt><dd><p>current trial, and session number included.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.data_thread">
<code class="sig-name descname">data_thread</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">queue</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.data_thread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.data_thread" title="Permalink to this definition">¶</a></dt>
<dd><p>Thread that keeps hdf file open and receives data while task is running.</p>
<p>receives data through <code class="xref py py-attr docutils literal notranslate"><span class="pre">queue</span></code> as dictionaries. Data can be
partial-trial data (eg. each phase of a trial) as long as the task returns a dict with
‘TRIAL_END’ as a key at the end of each trial.</p>
<p>each dict given to the queue should have the <cite>trial_num</cite>, and this method can
properly store data without passing <cite>TRIAL_END</cite> if so. I recommend being explicit, however.</p>
<p>Checks graduation state at the end of each trial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>queue</strong> (<a class="reference external" href="https://docs.python.org/3/library/queue.html#queue.Queue" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">queue.Queue</span></code></a>) – passed by <a class="reference internal" href="#autopilot.core.subject.Subject.prepare_run" title="autopilot.core.subject.Subject.prepare_run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_run()</span></code></a> and used by other
objects to pass data to be stored.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.save_data">
<code class="sig-name descname">save_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.save_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.save_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternate and equivalent method of putting data in the queue as <cite>Subject.data_queue.put(data)</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – trial data. each should have a ‘trial_num’, and a dictionary with key
‘TRIAL_END’ should be passed at the end of each trial.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.stop_run">
<code class="sig-name descname">stop_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.stop_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.stop_run" title="Permalink to this definition">¶</a></dt>
<dd><p>puts ‘END’ in the data_queue, which causes <a class="reference internal" href="#autopilot.core.subject.Subject.data_thread" title="autopilot.core.subject.Subject.data_thread"><code class="xref py py-meth docutils literal notranslate"><span class="pre">data_thread()</span></code></a> to end.</p>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.to_csv">
<code class="sig-name descname">to_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">task</span><span class="o">=</span><span class="default_value">'current'</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.to_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Export trial data to .csv</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – output path of .csv</p></li>
<li><p><strong>task</strong> (<em>str, int</em>) – not implemented, but in the future pull data from ‘current’ or other named task</p></li>
<li><p><strong>step</strong> (<em>str, int, list, tuple</em>) – Step to select, see <a class="reference internal" href="#autopilot.core.subject.Subject.get_trial_data" title="autopilot.core.subject.Subject.get_trial_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Subject.get_trial_data()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.get_trial_data">
<code class="sig-name descname">get_trial_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">what</span><span class="o">=</span><span class="default_value">'data'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.get_trial_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.get_trial_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get trial data from the current task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<em>int, list, ‘all’</em>) – Step that should be returned, can be one of</p>
<ul>
<li><p>-1: most recent step</p></li>
<li><p>int: a single step</p></li>
<li><p>list of two integers eg. [0, 5], an inclusive range of steps.</p></li>
<li><p>anything else, eg. ‘all’: all steps.</p></li>
</ul>
</li>
<li><p><strong>what</strong> (<em>str</em>) – What should be returned?</p>
<ul>
<li><p>‘data’ : Dataframe of requested steps’ trial data</p></li>
<li><p>‘variables’: dict of variables <em>without</em> loading data into memory</p></li>
</ul>
</li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of requested steps’ trial data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.0.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.apply_along">
<code class="sig-name descname">apply_along</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">along</span><span class="o">=</span><span class="default_value">'session'</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.apply_along"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.apply_along" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.get_step_history">
<code class="sig-name descname">get_step_history</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">use_history</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.get_step_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.get_step_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a dataframe of step numbers, timestamps, and step names
as a coarse view of training status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>use_history</strong> (<em>bool</em>) – whether to use the history table or to reconstruct steps and dates from the trial table itself.
compatibility fix for old versions that didn’t stash step changes when the whole protocol was updated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.0.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.get_timestamp">
<code class="sig-name descname">get_timestamp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">simple</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.get_timestamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.get_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a timestamp.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>simple</strong> (<em>bool</em>) –</p>
<dl class="simple">
<dt>if True:</dt><dd><p>returns as format ‘%y%m%d-%H%M%S’, eg ‘190201-170811’</p>
</dd>
<dt>if False:</dt><dd><p>returns in isoformat, eg. ‘2019-02-01T17:08:02.058808’</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>basestring</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.get_weight">
<code class="sig-name descname">get_weight</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">which</span><span class="o">=</span><span class="default_value">'last'</span></em>, <em class="sig-param"><span class="n">include_baseline</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.get_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.get_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets start and stop weights.</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>add ability to get weights by session number, dates, and ranges.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>which</strong> (<em>str</em>) – if ‘last’, gets most recent weights. Otherwise returns all weights.</p></li>
<li><p><strong>include_baseline</strong> (<em>bool</em>) – if True, includes baseline and minimum mass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.set_weight">
<code class="sig-name descname">set_weight</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">col_name</span></em>, <em class="sig-param"><span class="n">new_value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.set_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.set_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates an existing weight in the weight table.</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>Yes, i know this is bad. Merge with update_weights</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> (<em>str</em>) – date in the ‘simple’ format, %y%m%d-%H%M%S</p></li>
<li><p><strong>col_name</strong> (<em>‘start’, ‘stop’</em>) – are we updating a pre-task or post-task weight?</p></li>
<li><p><strong>new_value</strong> (<em>float</em>) – New mass.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.update_weights">
<code class="sig-name descname">update_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">stop</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.update_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.update_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Store either a starting or stopping mass.</p>
<p><cite>start</cite> and <cite>stop</cite> can be passed simultaneously, <cite>start</cite> can be given in one
call and <cite>stop</cite> in a later call, but <cite>stop</cite> should not be given before <cite>start</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>float</em>) – Mass before running task in grams</p></li>
<li><p><strong>stop</strong> (<em>float</em>) – Mass after running task in grams.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="autopilot.core.subject.Subject.graduate">
<code class="sig-name descname">graduate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/autopilot/core/subject.html#Subject.graduate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#autopilot.core.subject.Subject.graduate" title="Permalink to this definition">¶</a></dt>
<dd><p>Increase the current step by one, unless it is the last step.</p>
</dd></dl>

<dl class="py class">
<dt id="autopilot.core.subject.Subject.History_Table">
<em class="property">class </em><code class="sig-name descname">History_Table</code><a class="headerlink" href="#autopilot.core.subject.Subject.History_Table" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tables.description.IsDescription</span></code></p>
<p>Class to describe parameter and protocol change history</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – timestamps</p></li>
<li><p><strong>type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Type of change - protocol, parameter, step</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Name - Which parameter was changed, name of protocol, manual vs. graduation step change</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Value - What was the parameter/protocol/etc. changed to, step if protocol.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="autopilot.core.subject.Subject.History_Table.columns">
<code class="sig-name descname">columns</code><em class="property"> = {'name': StringCol(itemsize=256, shape=(), dflt=b'', pos=None), 'time': StringCol(itemsize=256, shape=(), dflt=b'', pos=None), 'type': StringCol(itemsize=256, shape=(), dflt=b'', pos=None), 'value': StringCol(itemsize=4028, shape=(), dflt=b'', pos=None)}</em><a class="headerlink" href="#autopilot.core.subject.Subject.History_Table.columns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="autopilot.core.subject.Subject.Weight_Table">
<em class="property">class </em><code class="sig-name descname">Weight_Table</code><a class="headerlink" href="#autopilot.core.subject.Subject.Weight_Table" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tables.description.IsDescription</span></code></p>
<p>Class to describe table for weight history</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Pre-task mass</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Post-task mass</p></li>
<li><p><strong>date</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Timestamp in simple format</p></li>
<li><p><strong>session</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Session number</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="autopilot.core.subject.Subject.Weight_Table.columns">
<code class="sig-name descname">columns</code><em class="property"> = {'date': StringCol(itemsize=256, shape=(), dflt=b'', pos=None), 'session': Int32Col(shape=(), dflt=0, pos=None), 'start': Float32Col(shape=(), dflt=0.0, pos=None), 'stop': Float32Col(shape=(), dflt=0.0, pos=None)}</em><a class="headerlink" href="#autopilot.core.subject.Subject.Weight_Table.columns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="autopilot.core.subject.Subject.Hash_Table">
<em class="property">class </em><code class="sig-name descname">Hash_Table</code><a class="headerlink" href="#autopilot.core.subject.Subject.Hash_Table" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tables.description.IsDescription</span></code></p>
<p>Class to describe table for hash history</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Timestamps</p></li>
<li><p><strong>hash</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Hash of the currently checked out commit of the git repository.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="autopilot.core.subject.Subject.Hash_Table.columns">
<code class="sig-name descname">columns</code><em class="property"> = {'hash': StringCol(itemsize=40, shape=(), dflt=b'', pos=None), 'time': StringCol(itemsize=256, shape=(), dflt=b'', pos=None)}</em><a class="headerlink" href="#autopilot.core.subject.Subject.Hash_Table.columns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="autopilot.core.terminal.html" class="btn btn-neutral float-right" title="terminal" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="autopilot.core.styles.html" class="btn btn-neutral float-left" title="styles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Jonny Saunders

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>